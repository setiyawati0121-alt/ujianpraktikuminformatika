<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Peminjaman Barang - SMAN 1 Tarakan</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(to bottom, #0a0f2b, #1a1f40);
            color: #333;
            line-height: 1.6;
            padding-bottom: 50px;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Animasi Partikel Latar Belakang */
        .particles-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
        }
        
        .particle {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: floatParticle linear infinite;
        }
        
        @keyframes floatParticle {
            0% {
                transform: translateY(0) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.5;
            }
            90% {
                opacity: 0.5;
            }
            100% {
                transform: translateY(-100vh) translateX(100px) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Efek Glow pada Kontainer */
        .glow-container {
            position: relative;
            animation: glowPulse 4s ease-in-out infinite;
        }
        
        @keyframes glowPulse {
            0%, 100% {
                box-shadow: 0 0 5px rgba(42, 82, 152, 0.3);
            }
            50% {
                box-shadow: 0 0 20px rgba(42, 82, 152, 0.6);
            }
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }
        
        /* Header dengan animasi */
        header {
            background: linear-gradient(135deg, rgba(30, 60, 114, 0.9), rgba(42, 82, 152, 0.9));
            color: white;
            padding: 20px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideDown 1s ease-out;
        }
        
        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
        }
        
        .school-logo {
            display: flex;
            align-items: center;
            gap: 15px;
            animation: fadeInLeft 1s ease-out;
        }
        
        @keyframes fadeInLeft {
            from { transform: translateX(-50px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .school-logo img {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: 3px solid white;
            object-fit: cover;
            animation: rotateLogo 10s linear infinite;
        }
        
        @keyframes rotateLogo {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .school-info h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
            color: white;
        }
        
        .school-info h2 {
            font-size: 1.2rem;
            font-weight: 400;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .creator-info {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 10px 15px;
            border-radius: 8px;
            text-align: center;
            margin-top: 10px;
            flex-basis: 100%;
            color: white;
            animation: fadeInUp 1s ease-out 0.3s both;
        }
        
        @keyframes fadeInUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* Admin Mode Toggle */
        .admin-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
        }
        
        .admin-btn {
            background: linear-gradient(145deg, #ff9900, #e68a00);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 0 #b36b00, 0 8px 15px rgba(255, 153, 0, 0.3);
            transition: all 0.3s;
            z-index: 1001;
        }
        
        .admin-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 0 #b36b00, 0 12px 20px rgba(255, 153, 0, 0.4);
        }
        
        .admin-btn.active {
            background: linear-gradient(145deg, #d9534f, #c9302c);
            box-shadow: 0 4px 0 #a71e2a, 0 8px 15px rgba(217, 83, 79, 0.3);
        }
        
        /* Modal untuk Password Admin */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            animation: modalAppear 0.5s ease-out;
        }
        
        @keyframes modalAppear {
            from { 
                opacity: 0; 
                transform: scale(0.5) rotate(-10deg); 
            }
            to { 
                opacity: 1; 
                transform: scale(1) rotate(0); 
            }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            color: #2a5298;
            font-size: 1.5rem;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.8rem;
            color: #777;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .close-modal:hover {
            color: #d9534f;
            transform: rotate(90deg);
            transition: transform 0.3s;
        }
        
        .modal-input-group {
            margin-bottom: 20px;
        }
        
        .modal-input-group label {
            display: block;
            margin-bottom: 8px;
            color: #444;
            font-weight: 500;
        }
        
        .modal-input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .modal-input-group input:focus {
            border-color: #2a5298;
            outline: none;
            box-shadow: 0 0 0 3px rgba(42, 82, 152, 0.1);
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 25px;
        }
        
        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .modal-submit-btn {
            background: linear-gradient(145deg, #2a5298, #1e3c72);
            color: white;
        }
        
        .modal-submit-btn:hover {
            background: linear-gradient(145deg, #3a62a8, #2e4c82);
            transform: translateY(-2px);
        }
        
        .modal-cancel-btn {
            background: linear-gradient(145deg, #6c757d, #5a6268);
            color: white;
        }
        
        .modal-cancel-btn:hover {
            background: linear-gradient(145deg, #7c858d, #6a7278);
            transform: translateY(-2px);
        }
        
        /* Main Content */
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-top: 30px;
        }
        
        /* Form Section dengan animasi */
        .form-section, .data-section, .inventory-section, .return-section {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
            flex: 1;
            min-width: 300px;
            backdrop-filter: blur(5px);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }
        
        .form-section:hover, .data-section:hover, .inventory-section:hover, .return-section:hover {
            transform: translateY(-5px) scale(1.005);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.2);
        }
        
        .form-section:before, .data-section:before, .inventory-section:before, .return-section:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.7s;
        }
        
        .form-section:hover:before, .data-section:hover:before, .inventory-section:hover:before, .return-section:hover:before {
            left: 100%;
        }
        
        .return-section {
            flex-basis: 100%;
            margin-top: 20px;
        }
        
        .section-title {
            color: #2a5298;
            border-bottom: 2px solid #e6f0ff;
            padding-bottom: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: fadeIn 0.8s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .section-title i {
            font-size: 1.3rem;
        }
        
        .form-group {
            margin-bottom: 20px;
            animation: fadeIn 0.8s ease-out;
            animation-fill-mode: both;
        }
        
        .form-group:nth-child(1) { animation-delay: 0.1s; }
        .form-group:nth-child(2) { animation-delay: 0.2s; }
        .form-group:nth-child(3) { animation-delay: 0.3s; }
        .form-group:nth-child(4) { animation-delay: 0.4s; }
        .form-group:nth-child(5) { animation-delay: 0.5s; }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #444;
            font-weight: 500;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
            background-color: white;
            animation: fadeInUp 0.5s ease-out;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: #2a5298;
            outline: none;
            box-shadow: 0 0 0 3px rgba(42, 82, 152, 0.1), 0 0 10px rgba(42, 82, 152, 0.3);
            transform: scale(1.02);
        }
        
        .student-id-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .student-id-container .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        /* Tombol 3D dengan animasi */
        .class-3d-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .class-3d-item {
            perspective: 1000px;
            flex: 1;
            min-width: 80px;
            animation: popIn 0.5s ease-out;
            animation-fill-mode: both;
        }
        
        .class-3d-item:nth-child(1) { animation-delay: 0.1s; }
        .class-3d-item:nth-child(2) { animation-delay: 0.15s; }
        .class-3d-item:nth-child(3) { animation-delay: 0.2s; }
        .class-3d-item:nth-child(4) { animation-delay: 0.25s; }
        .class-3d-item:nth-child(5) { animation-delay: 0.3s; }
        .class-3d-item:nth-child(6) { animation-delay: 0.35s; }
        .class-3d-item:nth-child(7) { animation-delay: 0.4s; }
        .class-3d-item:nth-child(8) { animation-delay: 0.45s; }
        .class-3d-item:nth-child(9) { animation-delay: 0.5s; }
        .class-3d-item:nth-child(10) { animation-delay: 0.55s; }
        .class-3d-item:nth-child(11) { animation-delay: 0.6s; }
        .class-3d-item:nth-child(12) { animation-delay: 0.65s; }
        
        @keyframes popIn {
            0% {
                transform: scale(0.8);
                opacity: 0;
            }
            70% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .class-3d-btn {
            width: 100%;
            padding: 12px 8px;
            background: linear-gradient(145deg, #2a5298, #1e3c72);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            transform-style: preserve-3d;
            position: relative;
            box-shadow: 
                0 6px 0 #0a1a3a,
                0 12px 15px rgba(0, 0, 0, 0.3);
            text-align: center;
            animation: floatButton 3s ease-in-out infinite;
            font-size: 0.9rem;
        }
        
        @keyframes floatButton {
            0%, 100% { 
                transform: translateY(0) rotateX(0); 
            }
            50% { 
                transform: translateY(-5px) rotateX(5deg); 
                box-shadow: 
                    0 10px 0 #0a1a3a,
                    0 18px 20px rgba(0, 0, 0, 0.4);
            }
        }
        
        .class-3d-btn:hover {
            transform: translateY(-8px) rotateX(10deg) scale(1.05);
            box-shadow: 
                0 12px 0 #0a1a3a,
                0 22px 25px rgba(0, 0, 0, 0.5);
            background: linear-gradient(145deg, #3a62a8, #2e4c82);
            animation-play-state: paused;
        }
        
        .class-3d-btn:active {
            transform: translateY(2px) rotateX(5deg);
            box-shadow: 
                0 3px 0 #0a1a3a,
                0 6px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.1s ease;
        }
        
        .class-3d-btn.active {
            background: linear-gradient(145deg, #ff9900, #e68a00);
            box-shadow: 
                0 6px 0 #b36b00,
                0 12px 15px rgba(255, 153, 0, 0.3);
            animation: activeButton 1.5s ease-in-out infinite;
        }
        
        @keyframes activeButton {
            0%, 100% { 
                transform: translateY(0) scale(1); 
            }
            50% { 
                transform: translateY(-3px) scale(1.03); 
            }
        }
        
        .class-3d-btn.active:hover {
            background: linear-gradient(145deg, #ffaa33, #ff9900);
            box-shadow: 
                0 10px 0 #b36b00,
                0 18px 20px rgba(255, 153, 0, 0.4);
        }
        
        .class-level-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .level-btn {
            flex: 1;
            padding: 12px;
            background: linear-gradient(145deg, #4a6aa8, #3a5a98);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 0 #2a4a78, 0 10px 15px rgba(0, 0, 0, 0.2);
            text-align: center;
            animation: fadeInUp 0.5s ease-out;
        }
        
        .level-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 0 #2a4a78, 0 18px 22px rgba(0, 0, 0, 0.3);
        }
        
        .level-btn.active {
            background: linear-gradient(145deg, #ff9900, #e68a00);
            box-shadow: 0 5px 0 #b36b00, 0 10px 15px rgba(255, 153, 0, 0.2);
            animation: pulseActive 2s infinite;
        }
        
        @keyframes pulseActive {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }
        
        .selected-class-display {
            background: linear-gradient(145deg, #e6f0ff, #d1e0ff);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 5px solid #2a5298;
            font-weight: 700;
            color: #1e3c72;
            text-align: center;
            font-size: 1.2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            animation: fadeIn 0.8s ease-out;
        }
        
        /* Barang yang tersedia */
        .item-availability {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .item-availability select {
            flex: 3;
        }
        
        .availability-status {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            font-size: 0.9rem;
            min-width: 100px;
            transition: all 0.3s;
            animation: pulseStatus 2s infinite;
        }
        
        @keyframes pulseStatus {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .available {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .unavailable {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .item-quantity {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
        
        /* Inventory Table */
        .inventory-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            border-radius: 10px;
            overflow: hidden;
            animation: fadeIn 1s ease-out;
        }
        
        .inventory-table th, .inventory-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
            transition: all 0.3s;
        }
        
        .inventory-table th {
            background-color: #2a5298;
            color: white;
            font-weight: 600;
        }
        
        .inventory-table tr:nth-child(even) {
            background-color: #f9fbfd;
        }
        
        .inventory-table tr:hover {
            background-color: #eef4ff;
            transform: scale(1.01);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }
        
        .stock-indicator {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .stock-indicator:hover {
            transform: scale(1.1);
        }
        
        .stock-high {
            background-color: #d4edda;
            color: #155724;
        }
        
        .stock-medium {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .stock-low {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .stock-empty {
            background-color: #f5f5f5;
            color: #6c757d;
        }
        
        /* Form Admin */
        .admin-form-container {
            background-color: #f0f7ff;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border: 2px dashed #2a5298;
            display: none;
        }
        
        .admin-form-container h4 {
            color: #2a5298;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .admin-form-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        
        .admin-form-row .form-group {
            flex: 1;
            min-width: 200px;
            margin-bottom: 0;
        }
        
        .admin-actions {
            display: flex;
            gap: 10px;
        }
        
        .admin-btn-small {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .admin-add-btn {
            background: linear-gradient(145deg, #28a745, #218838);
            color: white;
            box-shadow: 0 4px 0 #1e7e34, 0 8px 15px rgba(40, 167, 69, 0.3);
        }
        
        .admin-add-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 0 #1e7e34, 0 12px 20px rgba(40, 167, 69, 0.4);
        }
        
        .admin-cancel-btn {
            background: linear-gradient(145deg, #6c757d, #5a6268);
            color: white;
            box-shadow: 0 4px 0 #3d4347, 0 8px 15px rgba(108, 117, 125, 0.3);
        }
        
        .admin-cancel-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 0 #3d4347, 0 12px 20px rgba(108, 117, 125, 0.4);
        }
        
        /* Form Pengembalian yang diperbaiki */
        .return-form-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .return-loan-list {
            flex: 1;
            min-width: 300px;
            animation: slideInLeft 0.8s ease-out;
        }
        
        @keyframes slideInLeft {
            from { transform: translateX(-50px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .return-details {
            flex: 1;
            min-width: 300px;
            background-color: #f9fbfd;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #2a5298;
            animation: slideInRight 0.8s ease-out;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(50px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .loan-list {
            max-height: 350px;
            overflow-y: auto;
            margin-top: 10px;
            padding-right: 5px;
        }
        
        /* Scrollbar styling */
        .loan-list::-webkit-scrollbar {
            width: 8px;
        }
        
        .loan-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .loan-list::-webkit-scrollbar-thumb {
            background: #2a5298;
            border-radius: 10px;
        }
        
        .loan-list::-webkit-scrollbar-thumb:hover {
            background: #1e3c72;
        }
        
        .loan-item {
            padding: 15px;
            border: 1px solid #e6f0ff;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .loan-item:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(42, 82, 152, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .loan-item:hover:before {
            left: 100%;
        }
        
        .loan-item:hover {
            background-color: #eef4ff;
            border-color: #2a5298;
            transform: translateX(5px) scale(1.02);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .loan-item.active {
            background-color: #e6f0ff;
            border-color: #2a5298;
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .loan-info {
            font-size: 0.9rem;
            color: #555;
        }
        
        .loan-info span {
            display: block;
            margin-bottom: 3px;
        }
        
        .loan-status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-top: 5px;
            animation: pulseStatus 2s infinite;
        }
        
        .status-dipinjam {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-dikembalikan {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-terlambat {
            background-color: #f8d7da;
            color: #721c24;
            animation: blinkWarning 1s infinite;
        }
        
        @keyframes blinkWarning {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .return-details h4 {
            color: #2a5298;
            margin-bottom: 15px;
            border-bottom: 1px solid #e6f0ff;
            padding-bottom: 10px;
        }
        
        .return-detail-item {
            margin-bottom: 10px;
            padding: 5px;
            border-radius: 5px;
            transition: all 0.3s;
        }
        
        .return-detail-item:hover {
            background-color: #f0f7ff;
            transform: translateX(3px);
        }
        
        .return-detail-item span:first-child {
            font-weight: 600;
            color: #444;
            display: inline-block;
            width: 120px;
        }
        
        .return-detail-item span:last-child {
            color: #666;
        }
        
        .condition-select {
            margin-top: 15px;
            margin-bottom: 15px;
        }
        
        .condition-select select {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 1rem;
        }
        
        .notes-input {
            margin-top: 15px;
        }
        
        .notes-input textarea {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 0.9rem;
            resize: vertical;
            min-height: 80px;
        }
        
        .late-warning {
            color: #d9534f;
            font-weight: 600;
            margin-top: 10px;
            padding: 10px;
            background-color: #f8d7da;
            border-radius: 8px;
            text-align: center;
            animation: shakeWarning 0.5s ease-in-out;
        }
        
        @keyframes shakeWarning {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .date-inputs {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .date-inputs .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        /* Tombol 3D untuk aksi dengan animasi */
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }
        
        .action-btn {
            padding: 16px 25px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transform-style: preserve-3d;
            position: relative;
            text-transform: uppercase;
            letter-spacing: 1px;
            animation: bounceIn 1s ease-out;
        }
        
        @keyframes bounceIn {
            0% {
                transform: scale(0.5);
                opacity: 0;
            }
            70% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .submit-btn {
            background: linear-gradient(145deg, #2a5298, #1e3c72);
            color: white;
            box-shadow: 
                0 8px 0 #0a1a3a,
                0 15px 20px rgba(42, 82, 152, 0.4);
        }
        
        .submit-btn:hover {
            transform: translateY(-8px) rotateX(10deg) scale(1.05);
            box-shadow: 
                0 15px 0 #0a1a3a,
                0 25px 30px rgba(42, 82, 152, 0.5);
            background: linear-gradient(145deg, #3a62a8, #2e4c82);
        }
        
        .submit-btn:active {
            transform: translateY(2px) rotateX(5deg);
            box-shadow: 
                0 4px 0 #0a1a3a,
                0 8px 10px rgba(42, 82, 152, 0.3);
            transition: all 0.1s ease;
        }
        
        .reset-btn {
            background: linear-gradient(145deg, #6c757d, #5a6268);
            color: white;
            box-shadow: 
                0 8px 0 #3d4347,
                0 15px 20px rgba(108, 117, 125, 0.4);
        }
        
        .reset-btn:hover {
            transform: translateY(-8px) rotateX(10deg) scale(1.05);
            box-shadow: 
                0 15px 0 #3d4347,
                0 25px 30px rgba(108, 117, 125, 0.5);
            background: linear-gradient(145deg, #7c858d, #6a7278);
        }
        
        .reset-btn:active {
            transform: translateY(2px) rotateX(5deg);
            box-shadow: 
                0 4px 0 #3d4347,
                0 8px 10px rgba(108, 117, 125, 0.3);
            transition: all 0.1s ease;
        }
        
        .return-btn {
            background: linear-gradient(145deg, #28a745, #218838);
            color: white;
            box-shadow: 
                0 8px 0 #1e7e34,
                0 15px 20px rgba(40, 167, 69, 0.4);
        }
        
        .return-btn:hover {
            transform: translateY(-8px) rotateX(10deg) scale(1.05);
            box-shadow: 
                0 15px 0 #1e7e34,
                0 25px 30px rgba(40, 167, 69, 0.5);
            background: linear-gradient(145deg, #38b755, #2e9e48);
        }
        
        .return-btn:active {
            transform: translateY(2px) rotateX(5deg);
            box-shadow: 
                0 4px 0 #1e7e34,
                0 8px 10px rgba(40, 167, 69, 0.3);
            transition: all 0.1s ease;
        }
        
        /* Data Section */
        .data-container {
            max-height: 500px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .data-item {
            background-color: #f9fbfd;
            border-left: 4px solid #2a5298;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 0 8px 8px 0;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s;
            animation: fadeInUp 0.5s ease-out;
            animation-fill-mode: both;
        }
        
        .data-item:nth-child(1) { animation-delay: 0.1s; }
        .data-item:nth-child(2) { animation-delay: 0.2s; }
        .data-item:nth-child(3) { animation-delay: 0.3s; }
        .data-item:nth-child(4) { animation-delay: 0.4s; }
        .data-item:nth-child(5) { animation-delay: 0.5s; }
        
        .data-item:hover {
            transform: translateX(8px) scale(1.02);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }
        
        .data-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .data-name {
            font-weight: 700;
            color: #2a5298;
            font-size: 1.1rem;
        }
        
        .data-class {
            background-color: #e6f0ff;
            color: #1e3c72;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .data-class:hover {
            transform: scale(1.05);
        }
        
        .data-details {
            color: #666;
            margin-bottom: 8px;
        }
        
        .data-details span {
            display: block;
            margin-bottom: 5px;
        }
        
        .late-fee {
            color: #d9534f;
            font-weight: 600;
            text-align: right;
            margin-top: 5px;
            margin-bottom: 10px;
            animation: pulseFee 2s infinite;
        }
        
        @keyframes pulseFee {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* Tombol Bayar Denda 3D */
        .pay-btn {
            background: linear-gradient(145deg, #d9534f, #c9302c);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 0 #a71e2a, 0 10px 15px rgba(217, 83, 79, 0.3);
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 10px;
            animation: shakeButton 3s ease-in-out infinite;
        }
        
        @keyframes shakeButton {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
            20%, 40%, 60%, 80% { transform: translateX(2px); }
        }
        
        .pay-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 0 #a71e2a, 0 20px 20px rgba(217, 83, 79, 0.4);
            background: linear-gradient(145deg, #e9635f, #d9534f);
            animation-play-state: paused;
        }
        
        .pay-btn:active {
            transform: translateY(1px);
            box-shadow: 0 3px 0 #a71e2a, 0 5px 10px rgba(217, 83, 79, 0.3);
            transition: all 0.1s ease;
        }
        
        /* Modal untuk QR Pembayaran */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-qr {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .modal-qr img {
            width: 200px;
            height: 200px;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 10px;
            animation: pulseQR 2s infinite;
        }
        
        @keyframes pulseQR {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }
        
        /* Animasi Bumi Berputar */
        .animation-section {
            flex-basis: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
            margin-top: 20px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
            animation: fadeIn 1s ease-out;
        }
        
        .animation-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 300px;
            position: relative;
            overflow: hidden;
            flex-direction: column;
        }
        
        .earth-container {
            position: relative;
            width: 150px;
            height: 150px;
            margin-bottom: 40px;
        }
        
        .earth {
            width: 150px;
            height: 150px;
            background: radial-gradient(circle at 30% 30%, #1e3c72, #2a5298, #0a0f2b);
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 40px rgba(0, 100, 255, 0.5);
            animation: rotateEarth 20s linear infinite;
        }
        
        .earth:before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 40% 40%, transparent 30%, rgba(255, 255, 255, 0.1) 100%);
            border-radius: 50%;
        }
        
        .earth-clouds {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1534088568595-a066f410bcda?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60');
            background-size: cover;
            border-radius: 50%;
            opacity: 0.3;
            animation: rotateClouds 15s linear infinite;
        }
        
        .orbit {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 250px;
            height: 250px;
            transform: translate(-50%, -50%);
            border: 1px dashed rgba(255, 255, 255, 0.3);
            border-radius: 50%;
        }
        
        .satellite {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #ffcc00;
            border-radius: 50%;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            animation: orbit 5s linear infinite;
        }
        
        .graduation-cap {
            position: absolute;
            width: 60px;
            height: 40px;
            background-color: #2a5298;
            border-radius: 50% 50% 0 0;
            top: 20px;
            left: 20px;
            transform: rotate(30deg);
            animation: float 4s ease-in-out infinite;
        }
        
        .graduation-cap:before {
            content: '';
            position: absolute;
            width: 80px;
            height: 20px;
            background-color: #1e3c72;
            top: 40px;
            left: -10px;
            border-radius: 10px;
        }
        
        .graduation-tassel {
            position: absolute;
            width: 5px;
            height: 30px;
            background-color: gold;
            top: 40px;
            left: 30px;
            animation: swing 2s ease-in-out infinite;
        }
        
        .quotes-container {
            position: relative;
            width: 100%;
            text-align: center;
            padding: 0 20px;
            margin-top: 20px;
        }
        
        .quote-text {
            color: #2a5298;
            font-weight: 600;
            font-size: 1.1rem;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
            font-style: italic;
            line-height: 1.5;
            max-width: 800px;
            margin: 0 auto 10px auto;
            animation: fadeInText 1.5s ease-in-out infinite alternate;
        }
        
        @keyframes fadeInText {
            from { opacity: 0.8; }
            to { opacity: 1; }
        }
        
        .quote-author {
            color: #d9534f;
            font-weight: 700;
            font-size: 1rem;
        }
        
        @keyframes rotateEarth {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes rotateClouds {
            from { transform: rotate(0deg); }
            to { transform: rotate(-360deg); }
        }
        
        @keyframes orbit {
            from { transform: rotate(0deg) translateX(125px) rotate(0deg); }
            to { transform: rotate(360deg) translateX(125px) rotate(-360deg); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(30deg); }
            50% { transform: translateY(-20px) rotate(30deg); }
        }
        
        @keyframes swing {
            0%, 100% { transform: rotate(-10deg); }
            50% { transform: rotate(10deg); }
        }
        
        /* QR Section */
        .qr-section {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
            margin-top: 30px;
            text-align: center;
            backdrop-filter: blur(5px);
            animation: fadeIn 1s ease-out;
        }
        
        .qr-container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 40px;
            margin-top: 20px;
        }
        
        .qr-code {
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 10px;
            background-color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s;
        }
        
        .qr-code:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        .qr-code img {
            width: 200px;
            height: 200px;
            display: block;
        }
        
        .qr-info {
            max-width: 500px;
            text-align: left;
        }
        
        .qr-info h3 {
            color: #2a5298;
            margin-bottom: 15px;
        }
        
        .qr-info p {
            margin-bottom: 15px;
            color: #555;
        }
        
        .phone-number {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1e3c72;
            margin: 15px 0;
            padding: 10px;
            background-color: #f0f8ff;
            border-radius: 8px;
            text-align: center;
            animation: pulsePhone 2s infinite;
        }
        
        @keyframes pulsePhone {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        .dana-logo {
            color: #00a2ff;
            font-weight: 700;
            font-size: 1.5rem;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        /* Footer */
        footer {
            text-align: center;
            margin-top: 40px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeIn 1s ease-out;
        }
        
        /* Responsive */
        @media (max-width: 1024px) {
            .container {
                padding: 0 15px;
            }
            
            .main-content {
                gap: 20px;
            }
            
            .class-3d-item {
                min-width: 80px;
            }
            
            .class-3d-btn {
                padding: 10px 5px;
                font-size: 0.85rem;
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                justify-content: center;
                text-align: center;
            }
            
            .school-logo {
                flex-direction: column;
                margin-bottom: 15px;
            }
            
            .main-content {
                flex-direction: column;
            }
            
            .student-id-container {
                flex-direction: column;
            }
            
            .date-inputs {
                flex-direction: column;
            }
            
            .class-3d-container {
                flex-direction: row;
                justify-content: center;
            }
            
            .class-3d-item {
                min-width: 70px;
                max-width: 100px;
            }
            
            .class-3d-btn {
                padding: 10px 5px;
                font-size: 0.8rem;
            }
            
            .level-btn {
                padding: 10px;
                font-size: 0.9rem;
            }
            
            .qr-container {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
            
            .qr-info {
                text-align: center;
                max-width: 100%;
            }
            
            .earth-container {
                margin: 0 0 30px 0;
            }
            
            .action-btn {
                padding: 14px 20px;
                font-size: 1rem;
            }
            
            .item-availability {
                flex-direction: column;
                gap: 10px;
            }
            
            .item-availability select {
                width: 100%;
            }
            
            .availability-status {
                width: 100%;
            }
            
            .return-form-container {
                flex-direction: column;
            }
            
            .admin-toggle {
                position: static;
                margin: 10px auto;
                display: flex;
                justify-content: center;
            }
            
            .admin-form-row {
                flex-direction: column;
            }
            
            .animation-container {
                height: 320px;
            }
            
            .section-title {
                font-size: 1.3rem;
            }
            
            .quote-text {
                font-size: 1rem;
                padding: 0 10px;
            }
            
            .modal-content {
                width: 95%;
                padding: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .school-info h1 {
                font-size: 1.5rem;
            }
            
            .school-info h2 {
                font-size: 1rem;
            }
            
            .class-3d-container {
                gap: 8px;
            }
            
            .class-3d-item {
                min-width: 60px;
                max-width: 80px;
            }
            
            .class-3d-btn {
                padding: 8px 4px;
                font-size: 0.75rem;
            }
            
            .selected-class-display {
                font-size: 1rem;
                padding: 12px;
            }
            
            .form-section, .data-section, .inventory-section, .return-section {
                padding: 20px;
            }
            
            .buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .action-btn {
                padding: 14px 15px;
                font-size: 0.95rem;
            }
            
            .section-title {
                font-size: 1.2rem;
            }
            
            .inventory-table {
                font-size: 0.85rem;
            }
            
            .inventory-table th, .inventory-table td {
                padding: 10px;
            }
            
            .qr-code img {
                width: 180px;
                height: 180px;
            }
            
            .phone-number {
                font-size: 1.1rem;
                padding: 8px;
            }
            
            .dana-logo {
                font-size: 1.2rem;
            }
            
            .animation-container {
                height: 280px;
            }
            
            .earth-container {
                width: 120px;
                height: 120px;
            }
            
            .earth {
                width: 120px;
                height: 120px;
            }
            
            .orbit {
                width: 200px;
                height: 200px;
            }
            
            .quote-text {
                font-size: 0.95rem;
            }
            
            .quote-author {
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 360px) {
            .class-3d-container {
                gap: 5px;
            }
            
            .class-3d-item {
                min-width: 55px;
                max-width: 70px;
            }
            
            .class-3d-btn {
                padding: 7px 3px;
                font-size: 0.7rem;
            }
            
            .level-btn {
                padding: 8px;
                font-size: 0.8rem;
            }
            
            .selected-class-display {
                font-size: 0.9rem;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Animasi Partikel Latar Belakang -->
    <div class="particles-container" id="particles"></div>
    
    <!-- Modal untuk Password Admin -->
    <div class="modal-overlay" id="adminPasswordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Masukkan Password Admin</h3>
                <button class="close-modal" id="closeAdminModal">&times;</button>
            </div>
            <div class="modal-input-group">
                <label for="adminPassword">Password:</label>
                <input type="password" id="adminPassword" placeholder="Masukkan password admin">
                <small style="color: #777; font-size: 0.85rem;">Password: admin123</small>
            </div>
            <div class="modal-buttons">
                <button type="button" class="modal-btn modal-submit-btn" id="submitAdminPassword">Masuk</button>
                <button type="button" class="modal-btn modal-cancel-btn" id="cancelAdminPassword">Batal</button>
            </div>
        </div>
    </div>
    
    <!-- Modal untuk QR Pembayaran -->
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Bayar Denda</h3>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            <div class="modal-qr">
                <!-- QR Code yang langsung mengarah ke aplikasi DANA -->
                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=DANA%3A%2F%2Ftransfer%3FphoneNumber%3D6285974637541%26amount%3D2000&format=png&color=1e3c72&bgcolor=ffffff" alt="QR Code DANA">
            </div>
            <div class="phone-number">62859-7463-7541</div>
            <p style="text-align: center; color: #555; margin-bottom: 15px;">Scan QR Code di atas untuk langsung membuka aplikasi DANA dan transfer ke nomor tujuan</p>
            <p style="text-align: center; color: #d9534f; font-weight: 600;">Tanggung Jawab adalah kunci kedewasaan. Bayar dendamu tepat waktu!</p>
        </div>
    </div>
    
    <!-- Tombol Mode Admin -->
    <div class="admin-toggle">
        <button class="admin-btn" id="adminToggleBtn">
            <i class="fas fa-user-shield"></i> Mode Admin
        </button>
    </div>
    
    <header>
        <div class="container">
            <div class="header-content">
                <div class="school-logo">
                    <img src="https://upload.wikimedia.org/wikipedia/id/thumb/6/67/Logo_Smansa_15_.png/250px-Logo_Smansa_15_.png" alt="Logo SMAN 1 Tarakan">
                    <div class="school-info">
                        <h1>SMAN 1 TARAKAN</h1>
                        <h2>Sistem Peminjaman Barang Sekolah</h2>
                    </div>
                </div>
                <div class="creator-info">
                    Dibuat oleh: <strong>SETIYAWATI</strong> | <strong>XII-J KESEHATAN 2</strong>
                </div>
            </div>
        </div>
    </header>
    
    <div class="container">
        <div class="main-content">
            <!-- Form Peminjaman -->
            <section class="form-section glow-container">
                <h2 class="section-title"><i class="fas fa-clipboard-list"></i> Form Peminjaman Barang</h2>
                <form id="loanForm">
                    <div class="form-group">
                        <label for="name">Nama Peminjam:</label>
                        <input type="text" id="name" placeholder="Masukkan nama lengkap" required>
                    </div>
                    
                    <div class="student-id-container">
                        <div class="form-group">
                            <label for="nisn">NISN:</label>
                            <input type="text" id="nisn" placeholder="Masukkan NISN" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="nis">NIS:</label>
                            <input type="text" id="nis" placeholder="Masukkan NIS" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Kelas:</label>
                        
                        <div class="class-level-selector">
                            <button type="button" class="level-btn" data-level="X">Kelas X</button>
                            <button type="button" class="level-btn" data-level="XI">Kelas XI</button>
                            <button type="button" class="level-btn active" data-level="XII">Kelas XII</button>
                        </div>
                        
                        <!-- Container untuk kelas X (A sampai L) -->
                        <div class="class-3d-container" id="classContainerX" style="display: none;">
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="X-A">X-A</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="X-B">X-B</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="X-C">X-C</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="X-D">X-D</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="X-E">X-E</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="X-F">X-F</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="X-G">X-G</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="X-H">X-H</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="X-I">X-I</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="X-J">X-J</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="X-K">X-K</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="X-L">X-L</button>
                            </div>
                        </div>
                        
                        <!-- Container untuk kelas XI (A sampai L) -->
                        <div class="class-3d-container" id="classContainerXI" style="display: none;">
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XI-A">XI-A</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XI-B">XI-B</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XI-C">XI-C</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XI-D">XI-D</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XI-E">XI-E</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XI-F">XI-F</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XI-G">XI-G</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XI-H">XI-H</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XI-I">XI-I</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XI-J">XI-J</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XI-K">XI-K</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XI-L">XI-L</button>
                            </div>
                        </div>
                        
                        <!-- Container untuk kelas XII (A sampai J) -->
                        <div class="class-3d-container" id="classContainerXII">
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XII-A">XII-A</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XII-B">XII-B</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XII-C">XII-C</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XII-D">XII-D</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XII-E">XII-E</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XII-F">XII-F</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XII-G">XII-G</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XII-H">XII-H</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn" data-class="XII-I">XII-I</button>
                            </div>
                            <div class="class-3d-item">
                                <button type="button" class="class-3d-btn active" data-class="XII-J">XII-J</button>
                            </div>
                        </div>
                        
                        <div class="selected-class-display" id="selectedClassDisplay">
                            Kelas yang dipilih: XII-J
                        </div>
                        <input type="hidden" id="selectedClass" value="XII-J" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="itemSelect">Barang yang Dipinjam:</label>
                        <div class="item-availability">
                            <select id="itemSelect" required>
                                <option value="">Pilih Barang</option>
                                <!-- Opsi akan diisi oleh JavaScript -->
                            </select>
                            <div class="availability-status" id="availabilityStatus">
                                Pilih barang
                            </div>
                        </div>
                        <div class="item-quantity" id="itemQuantity">
                            Pilih barang untuk melihat ketersediaan
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="itemQuantityInput">Jumlah yang Dipinjam:</label>
                        <input type="number" id="itemQuantityInput" min="1" value="1" required>
                        <small style="color: #777;">Maksimal jumlah berdasarkan stok yang tersedia</small>
                    </div>
                    
                    <div class="date-inputs">
                        <div class="form-group">
                            <label for="borrowDate">Tanggal Pinjam:</label>
                            <input type="date" id="borrowDate" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="returnDate">Tanggal Harus Kembali:</label>
                            <input type="date" id="returnDate" required>
                        </div>
                    </div>
                    
                    <div class="buttons">
                        <button type="submit" class="action-btn submit-btn">
                            <i class="fas fa-paper-plane"></i> Proses Peminjaman
                        </button>
                        <button type="button" class="action-btn reset-btn" id="resetBtn">
                            <i class="fas fa-redo"></i> Reset Form
                        </button>
                    </div>
                </form>
            </section>
            
            <!-- Form Pengembalian yang Diperbaiki -->
            <section class="return-section glow-container">
                <h2 class="section-title"><i class="fas fa-undo-alt"></i> Form Pengembalian Barang</h2>
                <div class="return-form-container">
                    <div class="return-loan-list">
                        <h4>Daftar Peminjaman Aktif</h4>
                        <div class="loan-list" id="activeLoansList">
                            <!-- Daftar peminjaman aktif akan ditampilkan di sini -->
                        </div>
                    </div>
                    
                    <div class="return-details">
                        <h4>Detail Pengembalian</h4>
                        <div id="returnDetails">
                            <p style="color: #777; text-align: center;">Pilih peminjaman dari daftar di samping</p>
                        </div>
                        
                        <div class="form-group">
                            <label for="actualReturnDateInput">Tanggal Pengembalian Aktual:</label>
                            <input type="date" id="actualReturnDateInput">
                        </div>
                        
                        <div class="form-group condition-select">
                            <label for="itemCondition">Kondisi Barang:</label>
                            <select id="itemCondition">
                                <option value="baik">Baik</option>
                                <option value="rusak_ringan">Rusak Ringan</option>
                                <option value="rusak_berat">Rusak Berat</option>
                                <option value="hilang">Hilang</option>
                            </select>
                        </div>
                        
                        <div class="form-group notes-input">
                            <label for="returnNotes">Catatan Pengembalian:</label>
                            <textarea id="returnNotes" placeholder="Masukkan catatan tentang kondisi barang atau informasi lainnya..."></textarea>
                        </div>
                        
                        <div id="lateFeeInfo" style="display: none;">
                            <div class="late-warning" id="lateWarning"></div>
                        </div>
                        
                        <div class="buttons">
                            <button type="button" class="action-btn return-btn" id="processReturnBtn" disabled>
                                <i class="fas fa-check-circle"></i> Proses Pengembalian
                            </button>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Data Peminjaman -->
            <section class="data-section glow-container">
                <h2 class="section-title"><i class="fas fa-history"></i> Riwayat Peminjaman</h2>
                <div class="data-container" id="dataContainer">
                    <!-- Data akan ditampilkan di sini -->
                    <div class="data-item">
                        <div class="data-header">
                            <div class="data-name">SETIYAWATI</div>
                            <div class="data-class">XII-J</div>
                            <span class="loan-status status-dikembalikan">DIKEMBALIKAN</span>
                        </div>
                        <div class="data-details">
                            <span><strong>NISN:</strong> 1234567890</span>
                            <span><strong>NIS:</strong> 20231234</span>
                            <span><strong>Barang:</strong> Buku Biologi (1 unit)</span>
                            <span><strong>Pinjam:</strong> 2 Februari 2026</span>
                            <span><strong>Harus Kembali:</strong> 5 Februari 2026</span>
                            <span><strong>Kembali Aktual:</strong> 7 Februari 2026</span>
                        </div>
                        <div class="late-fee">Denda: Rp 2,000</div>
                        <button class="pay-btn" onclick="showPaymentModal()">
                            <i class="fas fa-qrcode"></i> Bayar Denda via DANA
                        </button>
                    </div>
                </div>
            </section>
            
            <!-- Inventory Barang -->
            <section class="inventory-section glow-container">
                <h2 class="section-title"><i class="fas fa-boxes"></i> Daftar Barang Tersedia</h2>
                
                <!-- Form Admin untuk Menambah Barang -->
                <div class="admin-form-container" id="adminFormContainer">
                    <h4><i class="fas fa-plus-circle"></i> Tambah Barang Baru</h4>
                    <div class="admin-form-row">
                        <div class="form-group">
                            <label for="adminItemName">Nama Barang:</label>
                            <input type="text" id="adminItemName" placeholder="Contoh: Buku Matematika Kelas X">
                        </div>
                        <div class="form-group">
                            <label for="adminItemCategory">Kategori:</label>
                            <select id="adminItemCategory">
                                <option value="Buku Pelajaran">Buku Pelajaran</option>
                                <option value="Elektronik">Elektronik</option>
                                <option value="Alat Tulis">Alat Tulis</option>
                                <option value="Olahraga">Olahraga</option>
                                <option value="Laboratorium">Laboratorium</option>
                                <option value="Pendukung">Pendukung</option>
                            </select>
                        </div>
                    </div>
                    <div class="admin-form-row">
                        <div class="form-group">
                            <label for="adminItemStock">Stok Awal:</label>
                            <input type="number" id="adminItemStock" min="1" value="1">
                        </div>
                        <div class="form-group">
                            <label for="adminItemMaxStock">Stok Maksimal:</label>
                            <input type="number" id="adminItemMaxStock" min="1" value="10">
                        </div>
                        <div class="form-group">
                            <label for="adminItemLocation">Lokasi Penyimpanan:</label>
                            <input type="text" id="adminItemLocation" placeholder="Contoh: Rak Buku 1">
                        </div>
                    </div>
                    <div class="admin-actions">
                        <button type="button" class="admin-btn-small admin-add-btn" id="adminAddItemBtn">
                            <i class="fas fa-plus"></i> Tambah Barang
                        </button>
                        <button type="button" class="admin-btn-small admin-cancel-btn" id="adminCancelBtn">
                            <i class="fas fa-times"></i> Batal
                        </button>
                    </div>
                </div>
                
                <table class="inventory-table" id="inventoryTable">
                    <thead>
                        <tr>
                            <th>Nama Barang</th>
                            <th>Kategori</th>
                            <th>Stok Tersedia</th>
                            <th>Status</th>
                            <th>Lokasi Penyimpanan</th>
                            <th class="admin-only" style="display:none;">Aksi</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data inventory akan diisi oleh JavaScript -->
                    </tbody>
                </table>
            </section>
            
            <!-- Animasi Bumi Berputar dengan Quotes Tanggung Jawab -->
            <section class="animation-section">
                <h2 class="section-title"><i class="fas fa-quote-right"></i> Quotes Tanggung Jawab</h2>
                <div class="animation-container">
                    <div class="orbit"></div>
                    <div class="satellite"></div>
                    
                    <div class="earth-container">
                        <div class="earth">
                            <div class="earth-clouds"></div>
                        </div>
                    </div>
                    
                    <div class="graduation-cap">
                        <div class="graduation-tassel"></div>
                    </div>
                    
                    <div class="quotes-container">
                        <div class="quote-text" id="quoteText">
                            "Tanggung jawab dimulai dari hal kecil: mengembalikan barang pinjaman tepat waktu dan membayar denda jika terlambat."
                        </div>
                        <div class="quote-author" id="quoteAuthor">- Prinsip Kedewasaan -</div>
                    </div>
                </div>
            </section>
            
            <!-- QR Code -->
            <section class="qr-section">
                <h2 class="section-title"><i class="fas fa-qrcode"></i> Pembayaran Denda via DANA</h2>
                <div class="qr-container">
                    <div class="qr-code">
                        <!-- QR Code yang langsung mengarah ke aplikasi DANA -->
                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=DANA%3A%2F%2Ftransfer%3FphoneNumber%3D6285974637541%26amount%3D2000&format=png&color=1e3c72&bgcolor=ffffff" alt="QR Code DANA">
                    </div>
                    <div class="qr-info">
                        <h3>Instruksi Pembayaran Denda</h3>
                        <p>1. Scan QR Code di samping menggunakan aplikasi DANA</p>
                        <p>2. Aplikasi DANA akan langsung terbuka dengan nomor tujuan dan jumlah denda</p>
                        <p>3. Konfirmasi dan selesaikan pembayaran</p>
                        <p>4. Simpan bukti pembayaran untuk laporan</p>
                        
                        <div class="phone-number">62859-7463-7541</div>
                        
                        <p style="color: #d9534f; font-weight: 600; background-color: #fff3cd; padding: 10px; border-radius: 8px;">
                            <i class="fas fa-exclamation-circle"></i> 
                            QR Code ini langsung mengarah ke aplikasi DANA dengan nomor tujuan yang sudah diatur.
                        </p>
                        
                        <div class="dana-logo">
                            <i class="fas fa-bolt"></i> Powered by DANA
                        </div>
                        <p><a href="https://www.dana.id" target="_blank" style="color: #2a5298; font-weight: 600;">www.dana.id</a></p>
                    </div>
                </div>
            </section>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>&copy; 2026 SMAN 1 Tarakan - Sistem Peminjaman Barang Sekolah</p>
            <p>Dikembangkan oleh SETIYAWATI | XII-J KESEHATAN 2</p>
        </div>
    </footer>

    <script>
        // Array quotes tentang tanggung jawab
        const quotes = [
            {
                text: "Tanggung jawab dimulai dari hal kecil: mengembalikan barang pinjaman tepat waktu dan membayar denda jika terlambat.",
                author: "- Prinsip Kedewasaan -"
            },
            {
                text: "Orang yang bertanggung jawab tidak akan lari dari konsekuensi, termasuk membayar denda keterlambatan.",
                author: "- Etika Siswa SMAN 1 Tarakan -"
            },
            {
                text: "Kejujuran dan tanggung jawab dalam meminjam barang mencerminkan karakter sebagai calon pemimpin masa depan.",
                author: "- Visi Pendidikan -"
            },
            {
                text: "Membayar denda tepat waktu adalah investasi untuk membangun karakter disiplin yang akan berguna di dunia kerja nanti.",
                author: "- Persiapan Masa Depan -"
            },
            {
                text: "Sekolah bukan hanya tempat menuntut ilmu, tapi juga melatih tanggung jawab melalui hal-hal sederhana seperti meminjam barang.",
                author: "- Filosofi Pendidikan -"
            }
        ];
        
        // Data inventory barang
        let inventoryData = [
            { id: 1, name: "Buku Matematika Kelas XII", category: "Buku Pelajaran", stock: 15, maxStock: 30, location: "Rak Buku 1" },
            { id: 2, name: "Buku Biologi Kelas XII", category: "uku Pelajaran", stock: 8, maxStock: 20, location: "Rak Buku 2" },
            { id: 3, name: "Buku Kimia Kelas XII", category: "Buku Pelajaran", stock: 10, maxStock: 25, location: "Rak Buku 3" },
            { id: 4, name: "Proyektor LCD", category: "Elektronik", stock: 3, maxStock: 5, location: "Gudang Elektronik" },
            { id: 5, name: "Laptop Asus", category: "Elektronik", stock: 2, maxStock: 5, location: "Lab Komputer" },
            { id: 6, name: "Papan Tulis Whiteboard", category: "Alat Tulis", stock: 5, maxStock: 8, location: "Gudang Utama" },
            { id: 7, name: "Spidol Whiteboard (Pack)", category: "Alat Tulis", stock: 12, maxStock: 30, location: "Ruang Guru" },
            { id: 8, name: "Bola Basket", category: "Olahraga", stock: 4, maxStock: 10, location: "Gudang Olahraga" },
            { id: 9, name: "Net Voli", category: "Olahraga", stock: 2, maxStock: 3, location: "Gudang Olahraga" },
            { id: 10, name: "Alat Praktikum Kimia", category: "Laboratorium", stock: 3, maxStock: 5, location: "Lab Kimia" },
            { id: 11, name: "Mikroskop", category: "Laboratorium", stock: 1, maxStock: 3, location: "Lab Biologi" },
            { id: 12, name: "Peta Dunia", category: "Pendukung", stock: 2, maxStock: 4, location: "Perpustakaan" }
        ];
        
        // Data peminjaman (akan diisi secara dinamis)
        let loanRecords = [
            {
                id: 1,
                name: "SETIYAWATI",
                nisn: "1234567890",
                nis: "20231234",
                className: "XII-J",
                itemId: 2,
                itemName: "Buku Biologi Kelas XII",
                quantity: 1,
                borrowDate: "2026-02-02",
                returnDate: "2026-02-05",
                actualReturnDate: "2026-02-07",
                status: "dikembalikan",
                condition: "baik",
                notes: "Dikembalikan dalam kondisi baik",
                lateFee: 2000
            },
            {
                id: 2,
                name: "BUDI SANTOSO",
                nisn: "0987654321",
                nis: "20231235",
                className: "XII-A",
                itemId: 4,
                itemName: "Proyektor LCD",
                quantity: 1,
                borrowDate: "2026-02-01",
                returnDate: "2026-02-08",
                actualReturnDate: null,
                status: "dipinjam",
                condition: null,
                notes: null,
                lateFee: 0
            },
            {
                id: 3,
                name: "SARI DEWI",
                nisn: "1122334455",
                nis: "20231236",
                className: "XII-C",
                itemId: 8,
                itemName: "Bola Basket",
                quantity: 1,
                borrowDate: "2026-02-03",
                returnDate: "2026-02-10",
                actualReturnDate: null,
                status: "dipinjam",
                condition: null,
                notes: null,
                lateFee: 0
            }
        ];
        
        // Mode Admin
        let isAdminMode = false;
        const ADMIN_PASSWORD = "admin123"; // Password untuk mode admin
        
        // Fungsi untuk membuat partikel latar belakang
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                // Ukuran partikel acak
                const size = Math.random() * 10 + 2;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                // Posisi awal acak
                particle.style.left = `${Math.random() * 100}vw`;
                particle.style.top = `${Math.random() * 100 + 100}vh`;
                
                // Kecepatan animasi acak
                const duration = Math.random() * 20 + 10;
                const delay = Math.random() * 5;
                particle.style.animationDuration = `${duration}s`;
                particle.style.animationDelay = `${delay}s`;
                
                // Warna partikel acak
                const colors = [
                    'rgba(255, 255, 255, 0.3)',
                    'rgba(66, 133, 244, 0.3)',
                    'rgba(52, 168, 83, 0.3)',
                    'rgba(251, 188, 5, 0.3)',
                    'rgba(234, 67, 53, 0.3)'
                ];
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                particle.style.backgroundColor = randomColor;
                
                particlesContainer.appendChild(particle);
            }
        }
        
        // Fungsi untuk menampilkan modal pembayaran
        function showPaymentModal() {
            document.getElementById('paymentModal').style.display = 'flex';
        }
        
        // Fungsi untuk menutup modal pembayaran
        function closePaymentModal() {
            document.getElementById('paymentModal').style.display = 'none';
        }
        
        // Fungsi untuk menampilkan modal password admin
        function showAdminPasswordModal() {
            document.getElementById('adminPasswordModal').style.display = 'flex';
            document.getElementById('adminPassword').focus();
        }
        
        // Fungsi untuk menutup modal password admin
        function closeAdminPasswordModal() {
            document.getElementById('adminPasswordModal').style.display = 'none';
            document.getElementById('adminPassword').value = '';
        }
        
        // Fungsi untuk mengganti quote secara acak
        function changeQuote() {
            const randomIndex = Math.floor(Math.random() * quotes.length);
            const quote = quotes[randomIndex];
            
            document.getElementById('quoteText').textContent = quote.text;
            document.getElementById('quoteAuthor').textContent = quote.author;
        }
        
        // Fungsi untuk mengisi dropdown barang
        function populateItemDropdown() {
            const itemSelect = document.getElementById('itemSelect');
            itemSelect.innerHTML = '<option value="">Pilih Barang</option>';
            
            inventoryData.forEach(item => {
                const option = document.createElement('option');
                option.value = item.id;
                option.textContent = `${item.name} (Tersedia: ${item.stock})`;
                option.dataset.stock = item.stock;
                itemSelect.appendChild(option);
            });
        }
        
        // Fungsi untuk memperbarui status ketersediaan barang
        function updateItemAvailability() {
            const itemSelect = document.getElementById('itemSelect');
            const availabilityStatus = document.getElementById('availabilityStatus');
            const itemQuantity = document.getElementById('itemQuantity');
            const itemQuantityInput = document.getElementById('itemQuantityInput');
            
            const selectedItemId = itemSelect.value;
            
            if (!selectedItemId) {
                availabilityStatus.textContent = 'Pilih barang';
                availabilityStatus.className = 'availability-status';
                itemQuantity.textContent = 'Pilih barang untuk melihat ketersediaan';
                itemQuantityInput.max = 1;
                return;
            }
            
            const selectedItem = inventoryData.find(item => item.id == selectedItemId);
            
            if (selectedItem) {
                if (selectedItem.stock > 5) {
                    availabilityStatus.textContent = 'Tersedia';
                    availabilityStatus.className = 'availability-status available';
                } else if (selectedItem.stock > 0) {
                    availabilityStatus.textContent = 'Stok Terbatas';
                    availabilityStatus.className = 'availability-status available';
                } else {
                    availabilityStatus.textContent = 'Habis';
                    availabilityStatus.className = 'availability-status unavailable';
                }
                
                itemQuantity.textContent = `Stok tersedia: ${selectedItem.stock} dari ${selectedItem.maxStock} unit`;
                itemQuantityInput.max = selectedItem.stock;
                itemQuantityInput.value = Math.min(1, selectedItem.stock);
            }
        }
        
        // Fungsi untuk mengisi tabel inventory
        function populateInventoryTable() {
            const inventoryTable = document.getElementById('inventoryTable').getElementsByTagName('tbody')[0];
            inventoryTable.innerHTML = '';
            
            inventoryData.forEach(item => {
                const row = inventoryTable.insertRow();
                
                // Nama barang
                const nameCell = row.insertCell();
                nameCell.textContent = item.name;
                
                // Kategori
                const categoryCell = row.insertCell();
                categoryCell.textContent = item.category;
                
                // Stok tersedia
                const stockCell = row.insertCell();
                stockCell.textContent = `${item.stock} unit`;
                
                // Status
                const statusCell = row.insertCell();
                const statusSpan = document.createElement('span');
                statusSpan.className = 'stock-indicator ';
                
                if (item.stock === 0) {
                    statusSpan.textContent = 'Habis';
                    statusSpan.classList.add('stock-empty');
                } else if (item.stock <= 2) {
                    statusSpan.textContent = 'Sisa Sedikit';
                    statusSpan.classList.add('stock-low');
                } else if (item.stock <= 5) {
                    statusSpan.textContent = 'Terbatas';
                    statusSpan.classList.add('stock-medium');
                } else {
                    statusSpan.textContent = 'Tersedia';
                    statusSpan.classList.add('stock-high');
                }
                
                statusCell.appendChild(statusSpan);
                
                // Lokasi penyimpanan
                const locationCell = row.insertCell();
                locationCell.textContent = item.location;
                
                // Kolom aksi untuk admin mode
                if (isAdminMode) {
                    const actionCell = row.insertCell();
                    actionCell.style.textAlign = 'center';
                    
                    const deleteBtn = document.createElement('button');
                    deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
                    deleteBtn.className = 'admin-btn-small';
                    deleteBtn.style.backgroundColor = '#d9534f';
                    deleteBtn.style.color = 'white';
                    deleteBtn.style.border = 'none';
                    deleteBtn.style.padding = '5px 10px';
                    deleteBtn.style.borderRadius = '5px';
                    deleteBtn.style.cursor = 'pointer';
                    deleteBtn.title = 'Hapus barang';
                    deleteBtn.addEventListener('click', function() {
                        if (confirm(`Apakah Anda yakin ingin menghapus barang "${item.name}"?`)) {
                            inventoryData = inventoryData.filter(i => i.id !== item.id);
                            populateInventoryTable();
                            populateItemDropdown();
                        }
                    });
                    
                    actionCell.appendChild(deleteBtn);
                }
            });
        }
        
        // Fungsi untuk menampilkan daftar peminjaman aktif
        function renderActiveLoans() {
            const activeLoansList = document.getElementById('activeLoansList');
            activeLoansList.innerHTML = '';
            
            const activeLoans = loanRecords.filter(loan => loan.status === 'dipinjam');
            
            if (activeLoans.length === 0) {
                activeLoansList.innerHTML = '<p style="color: #777; text-align: center; padding: 20px;">Tidak ada peminjaman aktif</p>';
                return;
            }
            
            activeLoans.forEach(loan => {
                const loanItem = document.createElement('div');
                loanItem.className = 'loan-item';
                loanItem.dataset.id = loan.id;
                
                // Format tanggal
                const formatDate = (dateStr) => {
                    const date = new Date(dateStr);
                    return date.toLocaleDateString('id-ID', {
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric'
                    });
                };
                
                // Hitung keterlambatan
                const today = new Date();
                const returnDate = new Date(loan.returnDate);
                const isLate = today > returnDate;
                
                loanItem.innerHTML = `
                    <div style="font-weight: 600; color: #2a5298; margin-bottom: 5px;">${loan.name}</div>
                    <div class="loan-info">
                        <span><strong>Kelas:</strong> ${loan.className}</span>
                        <span><strong>Barang:</strong> ${loan.itemName} (${loan.quantity} unit)</span>
                        <span><strong>Pinjam:</strong> ${formatDate(loan.borrowDate)}</span>
                        <span><strong>Harus Kembali:</strong> ${formatDate(loan.returnDate)}</span>
                    </div>
                    <span class="loan-status ${isLate ? 'status-terlambat' : 'status-dipinjam'}">
                        ${isLate ? 'TERLAMBAT' : 'DIPINJAM'}
                    </span>
                `;
                
                // Event listener untuk memilih peminjaman
                loanItem.addEventListener('click', function() {
                    // Hapus kelas aktif dari semua item
                    document.querySelectorAll('.loan-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // Tambahkan kelas aktif ke item yang diklik
                    this.classList.add('active');
                    
                    // Tampilkan detail pengembalian
                    showReturnDetails(loan.id);
                });
                
                activeLoansList.appendChild(loanItem);
            });
        }
        
        // Fungsi untuk menampilkan detail pengembalian
        function showReturnDetails(loanId) {
            const loan = loanRecords.find(loan => loan.id == loanId);
            if (!loan) return;
            
            const returnDetails = document.getElementById('returnDetails');
            const processReturnBtn = document.getElementById('processReturnBtn');
            const actualReturnDateInput = document.getElementById('actualReturnDateInput');
            const lateFeeInfo = document.getElementById('lateFeeInfo');
            const itemConditionSelect = document.getElementById('itemCondition');
            const returnNotesTextarea = document.getElementById('returnNotes');
            
            // Format tanggal
            const formatDate = (dateStr) => {
                const date = new Date(dateStr);
                return date.toLocaleDateString('id-ID', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            };
            
            // Hitung keterlambatan
            const today = new Date();
            const returnDate = new Date(loan.returnDate);
            const isLate = today > returnDate;
            const diffTime = today - returnDate;
            const diffDays = isLate ? Math.ceil(diffTime / (1000 * 60 * 60 * 24)) : 0;
            const lateFee = isLate ? diffDays * 1000 : 0;
            
            // Set tanggal pengembalian default ke hari ini
            const todayStr = today.toISOString().split('T')[0];
            actualReturnDateInput.value = todayStr;
            actualReturnDateInput.min = loan.borrowDate;
            
            // Reset kondisi dan catatan
            itemConditionSelect.value = "baik";
            returnNotesTextarea.value = "";
            
            // Tampilkan detail
            returnDetails.innerHTML = `
                <div class="return-detail-item">
                    <span>Nama:</span>
                    <span>${loan.name}</span>
                </div>
                <div class="return-detail-item">
                    <span>Kelas:</span>
                    <span>${loan.className}</span>
                </div>
                <div class="return-detail-item">
                    <span>NISN:</span>
                    <span>${loan.nisn}</span>
                </div>
                <div class="return-detail-item">
                    <span>NIS:</span>
                    <span>${loan.nis}</span>
                </div>
                <div class="return-detail-item">
                    <span>Barang:</span>
                    <span>${loan.itemName} (${loan.quantity} unit)</span>
                </div>
                <div class="return-detail-item">
                    <span>Tanggal Pinjam:</span>
                    <span>${formatDate(loan.borrowDate)}</span>
                </div>
                <div class="return-detail-item">
                    <span>Harus Kembali:</span>
                    <span>${formatDate(loan.returnDate)}</span>
                </div>
            `;
            
            // Tampilkan peringatan keterlambatan
            if (isLate) {
                lateFeeInfo.style.display = 'block';
                document.getElementById('lateWarning').textContent = 
                    `Peminjaman terlambat ${diffDays} hari. Denda yang harus dibayar: Rp ${lateFee.toLocaleString('id-ID')}`;
            } else {
                lateFeeInfo.style.display = 'none';
            }
            
            // Aktifkan tombol proses pengembalian
            processReturnBtn.disabled = false;
            processReturnBtn.dataset.loanId = loanId;
        }
        
        // Fungsi untuk merender riwayat peminjaman
        function renderLoanHistory() {
            const dataContainer = document.getElementById('dataContainer');
            dataContainer.innerHTML = '';
            
            // Urutkan dari yang terbaru
            const sortedLoans = [...loanRecords].sort((a, b) => new Date(b.borrowDate) - new Date(a.borrowDate));
            
            sortedLoans.forEach(loan => {
                // Format tanggal
                const formatDate = (dateStr) => {
                    if (!dateStr) return 'Belum dikembalikan';
                    const date = new Date(dateStr);
                    return date.toLocaleDateString('id-ID', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                };
                
                // Tentukan status
                let statusClass = 'status-dipinjam';
                let statusText = 'DIPINJAM';
                
                if (loan.status === 'dikembalikan') {
                    statusClass = 'status-dikembalikan';
                    statusText = 'DIKEMBALIKAN';
                } else if (loan.actualReturnDate) {
                    statusClass = 'status-dikembalikan';
                    statusText = 'DIKEMBALIKAN';
                }
                
                // Buat elemen data
                const dataItem = document.createElement('div');
                dataItem.className = 'data-item';
                dataItem.innerHTML = `
                    <div class="data-header">
                        <div class="data-name">${loan.name}</div>
                        <div class="data-class">${loan.className}</div>
                        <span class="loan-status ${statusClass}">${statusText}</span>
                    </div>
                    <div class="data-details">
                        <span><strong>NISN:</strong> ${loan.nisn}</span>
                        <span><strong>NIS:</strong> ${loan.nis}</span>
                        <span><strong>Barang:</strong> ${loan.itemName} (${loan.quantity} unit)</span>
                        <span><strong>Pinjam:</strong> ${formatDate(loan.borrowDate)}</span>
                        <span><strong>Harus Kembali:</strong> ${formatDate(loan.returnDate)}</span>
                        <span><strong>Kembali Aktual:</strong> ${formatDate(loan.actualReturnDate)}</span>
                        ${loan.condition ? `<span><strong>Kondisi:</strong> ${loan.condition}</span>` : ''}
                        ${loan.notes ? `<span><strong>Catatan:</strong> ${loan.notes}</span>` : ''}
                    </div>
                `;
                
                // Tambahkan denda jika ada
                if (loan.lateFee && loan.lateFee > 0) {
                    dataItem.innerHTML += `
                        <div class="late-fee">Denda: Rp ${loan.lateFee.toLocaleString('id-ID')}</div>
                        <button class="pay-btn" onclick="showPaymentModal()">
                            <i class="fas fa-qrcode"></i> Bayar Denda via DANA
                        </button>
                    `;
                } else if (loan.status === 'dikembalikan') {
                    dataItem.innerHTML += '<div class="late-fee" style="color:green;">Tepat waktu (Tidak ada denda)</div>';
                }
                
                dataContainer.appendChild(dataItem);
            });
        }
        
        // Fungsi untuk toggle mode admin
        function toggleAdminMode() {
            // Tampilkan modal password
            showAdminPasswordModal();
        }
        
        // Fungsi untuk verifikasi password admin
        function verifyAdminPassword() {
            const passwordInput = document.getElementById('adminPassword').value;
            
            if (passwordInput === ADMIN_PASSWORD) {
                isAdminMode = true;
                const adminBtn = document.getElementById('adminToggleBtn');
                const adminFormContainer = document.getElementById('adminFormContainer');
                const adminColumns = document.querySelectorAll('.admin-only');
                
                adminBtn.classList.add('active');
                adminBtn.innerHTML = '<i class="fas fa-user-shield"></i> Mode Admin Aktif';
                adminFormContainer.style.display = 'block';
                
                // Tampilkan kolom aksi di tabel
                adminColumns.forEach(col => {
                    col.style.display = 'table-cell';
                });
                
                // Perbarui tabel untuk menampilkan kolom aksi
                populateInventoryTable();
                
                // Tutup modal
                closeAdminPasswordModal();
                
                alert('Mode Admin diaktifkan. Anda sekarang dapat menambah dan menghapus barang.');
            } else {
                alert('Password salah! Mode Admin tidak dapat diaktifkan.');
                document.getElementById('adminPassword').value = '';
                document.getElementById('adminPassword').focus();
            }
        }
        
        // Fungsi untuk menonaktifkan mode admin
        function disableAdminMode() {
            isAdminMode = false;
            const adminBtn = document.getElementById('adminToggleBtn');
            const adminFormContainer = document.getElementById('adminFormContainer');
            const adminColumns = document.querySelectorAll('.admin-only');
            
            adminBtn.classList.remove('active');
            adminBtn.innerHTML = '<i class="fas fa-user-shield"></i> Mode Admin';
            adminFormContainer.style.display = 'none';
            
            // Sembunyikan kolom aksi di tabel
            adminColumns.forEach(col => {
                col.style.display = 'none';
            });
            
            // Perbarui tabel untuk menyembunyikan kolom aksi
            populateInventoryTable();
            
            alert('Mode Admin dinonaktifkan.');
        }
        
        // Fungsi untuk menambah barang baru
        function addNewItem() {
            const itemName = document.getElementById('adminItemName').value;
            const itemCategory = document.getElementById('adminItemCategory').value;
            const itemStock = parseInt(document.getElementById('adminItemStock').value);
            const itemMaxStock = parseInt(document.getElementById('adminItemMaxStock').value);
            const itemLocation = document.getElementById('adminItemLocation').value;
            
            // Validasi input
            if (!itemName || !itemLocation) {
                alert('Nama barang dan lokasi penyimpanan harus diisi!');
                return;
            }
            
            if (itemStock < 1 || itemMaxStock < 1) {
                alert('Stok dan stok maksimal harus lebih dari 0!');
                return;
            }
            
            if (itemStock > itemMaxStock) {
                alert('Stok awal tidak boleh lebih besar dari stok maksimal!');
                return;
            }
            
            // Buat ID baru
            const newId = inventoryData.length > 0 ? Math.max(...inventoryData.map(item => item.id)) + 1 : 1;
            
            // Tambahkan barang baru
            inventoryData.push({
                id: newId,
                name: itemName,
                category: itemCategory,
                stock: itemStock,
                maxStock: itemMaxStock,
                location: itemLocation
            });
            
            // Reset form
            document.getElementById('adminItemName').value = '';
            document.getElementById('adminItemStock').value = '1';
            document.getElementById('adminItemMaxStock').value = '10';
            document.getElementById('adminItemLocation').value = '';
            
            // Perbarui tampilan
            populateInventoryTable();
            populateItemDropdown();
            
            alert(`Barang "${itemName}" berhasil ditambahkan!`);
        }
        
        // Fungsi untuk mengubah tampilan kelas berdasarkan tingkat yang dipilih
        function switchClassContainer(level) {
            // Sembunyikan semua container kelas
            document.getElementById('classContainerX').style.display = 'none';
            document.getElementById('classContainerXI').style.display = 'none';
            document.getElementById('classContainerXII').style.display = 'none';
            
            // Tampilkan container kelas yang sesuai
            document.getElementById(`classContainer${level}`).style.display = 'flex';
            
            // Reset tombol kelas yang aktif
            const classButtons = document.querySelectorAll('.class-3d-btn');
            classButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Set tombol kelas pertama sebagai aktif
            const firstClassBtn = document.querySelector(`#classContainer${level} .class-3d-btn`);
            if (firstClassBtn) {
                firstClassBtn.classList.add('active');
                
                // Update display dan input
                const selectedClassDisplay = document.getElementById('selectedClassDisplay');
                const selectedClassInput = document.getElementById('selectedClass');
                selectedClassDisplay.textContent = `Kelas yang dipilih: ${firstClassBtn.getAttribute('data-class')}`;
                selectedClassInput.value = firstClassBtn.getAttribute('data-class');
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // Buat partikel latar belakang
            createParticles();
            
            // Isi dropdown barang dan tabel inventory
            populateItemDropdown();
            populateInventoryTable();
            renderActiveLoans();
            renderLoanHistory();
            
            // Ganti quote setiap 10 detik
            setInterval(changeQuote, 10000);
            
            // Event listener untuk modal pembayaran
            document.getElementById('closeModal').addEventListener('click', closePaymentModal);
            document.getElementById('paymentModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closePaymentModal();
                }
            });
            
            // Event listener untuk modal admin
            document.getElementById('closeAdminModal').addEventListener('click', closeAdminPasswordModal);
            document.getElementById('cancelAdminPassword').addEventListener('click', closeAdminPasswordModal);
            document.getElementById('submitAdminPassword').addEventListener('click', verifyAdminPassword);
            
            // Enter key untuk submit password
            document.getElementById('adminPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    verifyAdminPassword();
                }
            });
            
            // Set tanggal default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('borrowDate').value = today;
            
            const nextWeek = new Date();
            nextWeek.setDate(nextWeek.getDate() + 7);
            document.getElementById('returnDate').value = nextWeek.toISOString().split('T')[0];
            
            // Event listener untuk dropdown barang
            document.getElementById('itemSelect').addEventListener('change', updateItemAvailability);
            
            // Event listener untuk input jumlah barang
            document.getElementById('itemQuantityInput').addEventListener('change', function() {
                const itemSelect = document.getElementById('itemSelect');
                const selectedItemId = itemSelect.value;
                
                if (selectedItemId) {
                    const selectedItem = inventoryData.find(item => item.id == selectedItemId);
                    if (selectedItem && this.value > selectedItem.stock) {
                        alert(`Jumlah melebihi stok yang tersedia. Stok saat ini: ${selectedItem.stock}`);
                        this.value = selectedItem.stock;
                    }
                }
            });
            
            // Event listener untuk tombol tingkat kelas
            const levelButtons = document.querySelectorAll('.level-btn');
            levelButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    levelButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Ganti container kelas sesuai tingkat yang dipilih
                    const level = this.getAttribute('data-level');
                    switchClassContainer(level);
                });
            });
            
            // Event listener untuk tombol kelas 3D
            const classButtons = document.querySelectorAll('.class-3d-btn');
            const selectedClassDisplay = document.getElementById('selectedClassDisplay');
            const selectedClassInput = document.getElementById('selectedClass');
            
            classButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Hapus kelas aktif dari semua tombol di container yang sama
                    const container = this.closest('.class-3d-container');
                    container.querySelectorAll('.class-3d-btn').forEach(b => {
                        b.classList.remove('active');
                    });
                    
                    // Tambahkan kelas aktif ke tombol yang diklik
                    this.classList.add('active');
                    
                    // Update display dan input
                    selectedClassDisplay.textContent = `Kelas yang dipilih: ${this.getAttribute('data-class')}`;
                    selectedClassInput.value = this.getAttribute('data-class');
                });
            });
            
            // Event listener untuk reset form peminjaman
            document.getElementById('resetBtn').addEventListener('click', function() {
                document.getElementById('loanForm').reset();
                
                // Reset ke nilai default
                levelButtons.forEach(b => {
                    if (b.getAttribute('data-level') === 'XII') {
                        b.classList.add('active');
                    } else {
                        b.classList.remove('active');
                    }
                });
                
                // Set container kelas XII sebagai aktif
                switchClassContainer('XII');
                
                // Reset tanggal ke default
                document.getElementById('borrowDate').value = today;
                document.getElementById('returnDate').value = nextWeek.toISOString().split('T')[0];
                
                // Reset ketersediaan barang
                updateItemAvailability();
            });
            
            // Event listener untuk submit form peminjaman
            document.getElementById('loanForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Validasi kelas
                const selectedClass = selectedClassInput.value;
                if (!selectedClass) {
                    alert('Silakan pilih kelas!');
                    return;
                }
                
                // Validasi NISN dan NIS
                const nisn = document.getElementById('nisn').value;
                const nis = document.getElementById('nis').value;
                
                if (!nisn || !nis) {
                    alert('Silakan isi NISN dan NIS!');
                    return;
                }
                
                // Validasi barang
                const itemSelect = document.getElementById('itemSelect');
                const selectedItemId = itemSelect.value;
                
                if (!selectedItemId) {
                    alert('Silakan pilih barang!');
                    return;
                }
                
                // Validasi jumlah barang
                const itemQuantity = parseInt(document.getElementById('itemQuantityInput').value);
                if (itemQuantity <= 0) {
                    alert('Jumlah barang harus lebih dari 0!');
                    return;
                }
                
                // Ambil data barang yang dipilih
                const selectedItem = inventoryData.find(item => item.id == selectedItemId);
                
                // Validasi stok barang
                if (itemQuantity > selectedItem.stock) {
                    alert(`Jumlah barang melebihi stok yang tersedia. Stok saat ini: ${selectedItem.stock}`);
                    return;
                }
                
                // Ambil nilai dari form
                const name = document.getElementById('name').value;
                const itemName = itemSelect.options[itemSelect.selectedIndex].text;
                const borrowDate = document.getElementById('borrowDate').value;
                const returnDate = document.getElementById('returnDate').value;
                
                // Kurangi stok barang
                selectedItem.stock -= itemQuantity;
                
                // Buat ID unik untuk peminjaman
                const loanId = loanRecords.length > 0 ? Math.max(...loanRecords.map(loan => loan.id)) + 1 : 1;
                
                // Tambahkan data peminjaman baru
                const newLoan = {
                    id: loanId,
                    name: name,
                    nisn: nisn,
                    nis: nis,
                    className: selectedClass,
                    itemId: parseInt(selectedItemId),
                    itemName: selectedItem.name,
                    quantity: itemQuantity,
                    borrowDate: borrowDate,
                    returnDate: returnDate,
                    actualReturnDate: null,
                    status: 'dipinjam',
                    condition: null,
                    notes: null,
                    lateFee: 0
                };
                
                loanRecords.push(newLoan);
                
                // Perbarui tampilan
                populateItemDropdown();
                populateInventoryTable();
                renderActiveLoans();
                renderLoanHistory();
                updateItemAvailability();
                
                // Reset form setelah submit
                document.getElementById('resetBtn').click();
                
                // Beri pesan sukses
                alert(`Peminjaman berhasil! Barang "${selectedItem.name}" sebanyak ${itemQuantity} unit telah dipinjam. Stok tersisa: ${selectedItem.stock}`);
            });
            
            // Event listener untuk proses pengembalian
            document.getElementById('processReturnBtn').addEventListener('click', function() {
                const loanId = this.dataset.loanId;
                if (!loanId) return;
                
                const loan = loanRecords.find(loan => loan.id == loanId);
                if (!loan) return;
                
                const actualReturnDateInput = document.getElementById('actualReturnDateInput');
                const actualReturnDate = actualReturnDateInput.value;
                const itemCondition = document.getElementById('itemCondition').value;
                const returnNotes = document.getElementById('returnNotes').value;
                
                if (!actualReturnDate) {
                    alert('Silakan isi tanggal pengembalian aktual!');
                    return;
                }
                
                // Validasi tanggal pengembalian
                if (new Date(actualReturnDate) < new Date(loan.borrowDate)) {
                    alert('Tanggal pengembalian tidak boleh lebih awal dari tanggal peminjaman!');
                    return;
                }
                
                // Hitung denda
                const returnDateTime = new Date(loan.returnDate);
                const actualReturnDateTime = new Date(actualReturnDate);
                let lateFee = 0;
                
                if (actualReturnDateTime > returnDateTime) {
                    const diffTime = actualReturnDateTime - returnDateTime;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    lateFee = diffDays * 1000;
                }
                
                // Update data peminjaman
                loan.actualReturnDate = actualReturnDate;
                loan.status = 'dikembalikan';
                loan.condition = itemCondition;
                loan.notes = returnNotes;
                loan.lateFee = lateFee;
                
                // Tambah stok barang yang dikembalikan (kecuali jika hilang atau rusak berat)
                if (itemCondition !== 'hilang' && itemCondition !== 'rusak_berat') {
                    const returnedItem = inventoryData.find(item => item.id == loan.itemId);
                    if (returnedItem) {
                        returnedItem.stock += loan.quantity;
                    }
                }
                
                // Perbarui tampilan
                populateItemDropdown();
                populateInventoryTable();
                renderActiveLoans();
                renderLoanHistory();
                
                // Reset form pengembalian
                document.getElementById('returnDetails').innerHTML = 
                    '<p style="color: #777; text-align: center;">Pilih peminjaman dari daftar di samping</p>';
                document.getElementById('processReturnBtn').disabled = true;
                document.getElementById('lateFeeInfo').style.display = 'none';
                
                // Hapus kelas aktif dari daftar peminjaman
                document.querySelectorAll('.loan-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                // Beri pesan sukses
                let message = 'Pengembalian berhasil!';
                if (lateFee > 0) {
                    message += ` Denda yang harus dibayar: Rp ${lateFee.toLocaleString('id-ID')}`;
                } else {
                    message += ' Tidak ada denda.';
                }
                
                if (itemCondition === 'hilang' || itemCondition === 'rusak_berat') {
                    message += '\n\nCatatan: Barang tidak ditambahkan kembali ke stok karena kondisi ' + 
                              (itemCondition === 'hilang' ? 'hilang.' : 'rusak berat.');
                }
                
                alert(message);
            });
            
            // Event listener untuk tombol admin
            document.getElementById('adminToggleBtn').addEventListener('click', toggleAdminMode);
            
            // Event listener untuk tombol tambah barang (admin)
            document.getElementById('adminAddItemBtn').addEventListener('click', addNewItem);
            
            // Event listener untuk tombol batal (admin)
            document.getElementById('adminCancelBtn').addEventListener('click', function() {
                document.getElementById('adminItemName').value = '';
                document.getElementById('adminItemStock').value = '1';
                document.getElementById('adminItemMaxStock').value = '10';
                document.getElementById('adminItemLocation').value = '';
            });
            
            // Inisialisasi dengan data contoh
            changeQuote();
            updateItemAvailability();
        });
    </script>
</body>
</html>